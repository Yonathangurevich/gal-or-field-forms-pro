<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Forms Management System</title>
    <meta name="description" content="Progressive Web App for managing Google Forms distribution to field agents" />
    <meta name="theme-color" content="#2563eb" />
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="/manifest.json">
    <link rel="manifest" href="/manifest.json" />
    <link rel="apple-touch-icon" href="/icon-192.svg" />
    <meta name="theme-color" content="#5b7cfd">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Forms Manager" />
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="/src/main.css" rel="stylesheet" />
</head>

<body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    
    <script>
        // Register service worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        // PWA Install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show custom install button if needed
            const installBanner = document.createElement('div');
            installBanner.innerHTML = `
                <div style="
                    position: fixed; 
                    bottom: 20px; 
                    right: 20px; 
                    background: #2563eb; 
                    color: white; 
                    padding: 12px 16px; 
                    border-radius: 8px; 
                    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                    z-index: 1000;
                    font-family: Inter, sans-serif;
                    font-size: 14px;
                    max-width: 250px;
                    text-align: center;
                    direction: rtl;
                ">
                    <div style="margin-bottom: 8px;">התקן את האפליקציה למכשיר</div>
                    <button id="installBtn" style="
                        background: white; 
                        color: #2563eb; 
                        border: none; 
                        padding: 6px 12px; 
                        border-radius: 4px; 
                        font-size: 12px; 
                        cursor: pointer;
                        margin-left: 8px;
                    ">התקן</button>
                    <button id="dismissBtn" style="
                        background: transparent; 
                        color: white; 
                        border: 1px solid white; 
                        padding: 6px 12px; 
                        border-radius: 4px; 
                        font-size: 12px; 
                        cursor: pointer;
                    ">לא עכשיו</button>
                </div>
            `;
            
            document.body.appendChild(installBanner);
            
            document.getElementById('installBtn').addEventListener('click', () => {
                installBanner.remove();
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    deferredPrompt = null;
                });
            });
            
            document.getElementById('dismissBtn').addEventListener('click', () => {
                installBanner.remove();
            });
        });
    </script>
</body>

</html>
